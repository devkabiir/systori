{% extends "field/base.html" %}
{% load i18n staticfiles field_app %}

{% block container %}
  <div class="container">

    <div class="row back-buttons">
      <div class="col-xs-8"><a href="{% url 'field.projects' %}"
                               class="btn btn-default btn-block btn-back">&laquo; {% trans 'Projects' %}</a></div>
      <div class="col-xs-4"><a href="{% url 'field.dashboard' %}"
                               class="btn btn-default btn-block">&laquo; {% trans 'Dashboard' %}</a></div>
    </div>

    <div class="panel panel-default">

      <div class="panel-heading">
        {{ project.name }}
      </div>

      <div class="panel-body">
        {{ project.description }}
      </div>

    </div>

    {% for day, plans in daily_plans %}

      <div class="day-separator {% if day == today %}today{% endif %}">

        {% if day == selected_day %}
          {% include "field/project_datepicker.html" with day=day %}
        {% else %}
          {{ day|date:"l" }}, {{ day|date:"DATE_FORMAT" }}
        {% endif %}

        {% if user.is_staff and day >= today %}
          <a href="{% url 'field.dailyplan.pick-copy-date' project.id selected_day.isoformat selected_day.isoformat %}"
             class="btn btn-primary btn-contextual btn-copy-plan"><span class="glyphicon glyphicon-duplicate"></span></a>
          <a href="{% add_daily_plan_url project day %}?origin={{ request.path }}#{{ dailyplan.jobsite.project.id }}"
             class="btn btn-primary btn-contextual btn-add-plan"><span class="glyphicon glyphicon-plus"></span></a>
        {% endif %}

      </div>

      {% for plan in plans %}

        {% include "field/dailyplan.html" with dailyplan=plan %}

      {% empty %}

        {% comment %}Only selected_day could be empty.{% endcomment %}

        {% if user.is_staff and day < today %}

          <div>{% trans 'Cannot change the past.' %}</div>

        {% else %}

          <div>{% blocktrans with day=day %}No daily plans exist for {{ day }}.{% endblocktrans %}</div>

        {% endif %}

      {% endfor %}

    {% endfor %}

  </div>
{% endblock %}