{% extends "field/base.html" %}
{% load i18n staticfiles field_app %}

{% block container %}
<style>
.date-header {
  text-align: center;
  margin-top: -3px;
}
</style>
<div class="container">

  <div class="row back-buttons">
    <div class="col-xs-4"><a href="{% url 'field.dashboard' %}" class="btn btn-default btn-block">&laquo; {% trans 'Dashboard' %}</a></div>
    <div class="col-xs-4"><a href="{% url 'field.projects' %}" class="btn btn-default btn-block" style="text-align: center;">&uarr; {% trans 'Projects' %}</a></div>
    <div class="col-xs-2"><a href="{% url 'field.planning.toggle' selected_day.isoformat 'tasks' %}" class="btn btn-default btn-block {% if request.session.is_planning_tasks %}active{% endif %}" style="text-align: center;"><span class="glyphicon glyphicon-list" aria-hidden="true"></span></a></div>
    <div class="col-xs-2"><a href="{% url 'field.planning.toggle' selected_day.isoformat 'notes' %}" class="btn btn-default btn-block {% if request.session.is_planning_notes %}active{% endif %}" style="text-align: center;"><span class="glyphicon glyphicon-paperclip" aria-hidden="true"></span></a></div>
  </div>

  <div class="row back-buttons">
    <div class="col-xs-4"><a href="{{ previous_day_url }}" class="btn btn-default btn-block">&laquo; {{ previous_day|date:"N j" }}</a></div>
    <div class="col-xs-4 date-header">{{ selected_day|date:"DATE_FORMAT" }}<br />{{ selected_day|date:"l" }}</div>
    <div class="col-xs-4 text-right"><a href="{{ next_day_url }}" class="btn btn-default btn-block">{{ next_day|date:"N j" }} &raquo;</a></div>
  </div>

{% for plan in selected_plans %}

  {% ifchanged plan.jobsite.project.id %}

  <div class="day-separator">
    {{ plan.jobsite.project.name }}
    {% if user.is_staff and plan.day >= today %}
      <a href="{% add_daily_plan_url plan.jobsite.project plan.day %}?origin={{request.path}}" class="btn btn-primary btn-contextual btn-add-plan">{% trans 'Add' %}</a>
    {% endif %}
  </div>

  {% endifchanged %}

  {% include "field/dailyplan.html" with dailyplan=plan %}

{% empty %}


  {% if user.is_staff and selected_day >= today and latest_daily_plan.day < selected_day %}
    <a href="{% url 'field.planning.generate' selected_day %}" class="btn btn-primary">{% blocktrans with otherday=latest_daily_plan.day %}Copy from {{ otherday }}.{% endblocktrans %}</a>
  {% endif %}

{% endfor %}

</div>
{% endblock %}
