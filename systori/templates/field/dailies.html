{% extends "field/base.html" %}
{% load i18n staticfiles %}

{% block container %}
<style>
.date-header {
  text-align: center;
  margin-top: -3px;
}
</style>
<div class="container">

  <div class="row back-buttons">
    <div class="col-xs-6"><a href="{% url 'field.dashboard' %}" class="btn btn-default btn-block">&laquo; {% trans 'Dashboard' %}</a></div>
    <div class="col-xs-6"><a href="{{ today_url }}" class="btn btn-default btn-block" style="text-align: center;">{% trans 'Today' %}, {% now 'DATE_FORMAT' %}</a></div>
  </div>

  <div class="row back-buttons">
    <div class="col-xs-4"><a href="{{ previous_day_url }}" class="btn btn-default btn-block">&laquo; {{ previous_day|date:"N j" }}</a></div>
    <div class="col-xs-4 date-header">{{ selected_day|date:"DATE_FORMAT" }}<br />{{ selected_day|date:"l" }}</div>
    <div class="col-xs-4 text-right"><a href="{{ next_day_url }}" class="btn btn-default btn-block">{{ next_day|date:"N j" }} &raquo;</a></div>
  </div>

  {% for plan in todays_plans %}

  <div class="panel panel-primary">

    <div class="list-group">
      <a href="{% url 'field.project' plan.jobsite.project_id %}" class="list-group-item active">
        <span class="pull-right">&raquo;</span>
        <b>{{ plan.jobsite.project.name }}</b><br/>
        {{ plan.jobsite.name }} - {{ plan.jobsite.address }} {{ plan.jobsite.city }}
      </a>
    </div>

    <div class="list-group">

      <div class="list-group-item sub-header">
        {% trans "Workers" %}
      </div>
    
      {% for member in plan.members.all %}
      <div class="list-group-item"> {{ member.member.get_full_name }} {% if member.is_foreman %}<span class="pull-right">{% trans 'Foreman' %}</span>{% endif %}</div>
      {% endfor %}

      <div class="list-group-item sub-header">
        {% trans "Tasks" %}
      </div>

      {% for task in plan.tasks.all %}
      <a href="{% url 'field.task' plan.jobsite.project.id plan.jobsite.id task.taskgroup.job.id task.id %}?origin={{request.path}}" class="list-group-item clearfix">
        {{ task.name }}
        {% if task.complete_percent > 0 %}
        <span class="badge">{{ task.complete_percent }}%</span>
        {% else %}
        <span class="pull-right">&raquo;</span>
        {% endif %}
      </a>
      {% endfor %}

    </div>

  </div>
  
  {% endfor %}


</div>
{% endblock %}